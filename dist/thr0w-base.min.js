!function(){"use strict";function t(t){d=t}function e(t,e,n){function s(t){function e(t){t||(h.style.display="none",f.style.display="block")}t.preventDefault();var n=h.querySelector("#thr0w_base_login__username").value,o=h.querySelector("#thr0w_base_login__password").value;n&&o&&i(n,o,e)}function c(t){function i(t){t||(f.style.display="none",e())}t.preventDefault();var o=parseInt(f.querySelector("#thr0w_base_connect__connect__channel").value);(!o||0>o)&&(o=0),a(o,i,n)}if(void 0===t||"object"!=typeof t)throw 400;if(void 0===e||"function"!=typeof e)throw 400;if(void 0===n||"function"!=typeof n)throw 400;var l,h=document.createElement("form"),f=document.createElement("div");h.id="thr0w_base_login",h.innerHTML=['<input id="thr0w_base_login__username" type="text" placeholder="Username">','<input id="thr0w_base_login__password" type="password" placeholder="Password">','<button type="submit">Login</button>'].join(""),f.id="thr0w_base_connect",f.innerHTML=['<form id="thr0w_base_connect__connect">','<input id="thr0w_base_connect__connect__channel" type="number" />','<button type="submit">Connect</button>',"</form>",'<button id="thr0w_base_connect__logout">Logout</button>'].join(""),t.appendChild(h),t.appendChild(f),l=f.querySelector("#thr0w_base_connect__connect"),r()?f.style.display="block":h.style.display="block",h.addEventListener("submit",s),f.querySelector("#thr0w_base_connect__logout").addEventListener("click",o),l.addEventListener("submit",c)}function n(){return y}function i(t,e,n){function i(){if(4===s.readyState){if(200===s.status){var t;try{t=JSON.parse(s.responseText).token}catch(e){return n(500)}return t?(window.localStorage.setItem("thr0w_token",t),n(null)):n(500)}return n(s.status?s.status:500)}}if(void 0===t||"string"!=typeof t)throw 400;if(void 0===e||"string"!=typeof e)throw 400;if(void 0===n||"function"!=typeof n)throw 400;var o=d+":3000/api/login",r="username="+t+"&password="+e,s=new XMLHttpRequest;s.open("POST",o,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=i,s.send(r)}function o(){window.localStorage.removeItem("thr0w_token"),window.location.reload()}function r(){return null!==window.localStorage.getItem("thr0w_token")}function s(t,e){var n=d+":3000/api/thr0w",i=window.localStorage.getItem("thr0w_token"),o=new XMLHttpRequest;o.open("POST",n,!0),o.setRequestHeader("Authorization","bearer "+i),o.setRequestHeader("Content-type","application/json"),o.send(JSON.stringify({channels:t,message:e}))}function a(t,e,n){function i(){w.disconnect(),e(500)}function o(){function t(){window.location.reload()}window.clearTimeout(a),w.on("message",n),w.on("duplicate",t),e(null)}var s,a;if(!w){if(!r())throw 400;if(void 0===t||"number"!=typeof t)throw 400;if(void 0===e||"function"!=typeof e)throw 400;if(void 0===n||"function"!=typeof n)throw 400;y=t,s=window.localStorage.getItem("thr0w_token"),a=window.setTimeout(i,5e3),w=window.io(d+":3001"),w.on("authenticated",o),w.emit("authenticate",JSON.stringify({token:s,channel:y}))}}function c(t,e){if(!w)throw 400;w.emit("thr0w",JSON.stringify({channels:t,message:e}))}function l(t,e,n){function i(){return t}function o(){return e}function r(){return n}function s(){return e.offsetWidth}function a(){return e.offsetHeight}if(!w)throw 400;if(void 0===t||"object"!=typeof t)throw 400;if(void 0===e||"object"!=typeof e)throw 400;if(void 0===n||!Array.isArray(n))throw 400;for(var c,l,h=0;h<n.length;h++)for(var f=0;f<n[h].length;f++)y===n[h][f]&&(c=f,l=h);e.style.left="-"+c*t.clientWidth+"px",e.style.top="-"+l*t.clientHeight+"px",this.getFrame=i,this.getContent=o,this.getMatrix=r,this.getWidth=s,this.getHeight=a}function h(t,e,n,i){function o(){return t}function r(){return e}function s(){return n}function a(){return d}function c(){return p}if(!w)throw 400;if(void 0===t||"object"!=typeof t)throw 400;if(void 0===e||"object"!=typeof e)throw 400;if(void 0===n||!Array.isArray(n))throw 400;if(void 0===i||!Array.isArray(i))throw 400;var l,h,f,u,d=0,p=0,g=0,_=0;for(l=0;l<n.length;l++)for(i[l].scale=i[l].scale?i[l].scale:1,d=Math.max(i[l].scale*i[l].width*n[l].length,d),p+=i[l].scale*i[l].height,h=0;h<n[l].length;h++)y===n[l][h]&&(f=h,u=l);for(t.style.width=i[u].scale*i[u].width+"px",t.style.height=i[u].scale*i[u].height+"px",t.style.transform="scale("+1/i[u].scale+", "+1/i[u].scale+")",e.style.width=d+"px",e.style.height=p+"px",l=0;u>l;l++)_+=i[l].scale*i[l].height;g=f*i[u].scale*i[u].width+f*(d-n[u].length*i[u].scale*i[u].width)/(n[u].length-1),e.style.left="-"+g+"px",e.style.top="-"+_+"px",this.getFrame=o,this.getContent=r,this.getMatrix=s,this.getWidth=a,this.getHeight=c}function f(t,e,n,i){function o(){d||(u||(u=!0,p=!0,c(f,{thr0w:{type:"sync",_id:e,lock:!0}})),c(f,{thr0w:{type:"sync",_id:e,message:n()}}))}function r(){d||(u=!1,c(f,{thr0w:{type:"sync",_id:e,unlock:!0}}))}function s(t){var o=t.message;if(void 0!==o&&t.source!==y){var r=o.thr0w;if(void 0!==r&&"sync"===r.type&&r._id===e){if(r.hello)return u&&c(f,{thr0w:{type:"sync",_id:e,lock:!0}}),void(p&&c(f,{thr0w:{type:"sync",_id:e,message:n()}}));if(!u)return r.lock&&!u?(p=!1,d=!0,void(_.style.visibility="visible")):r.unlock&&!u?(d=!1,void(_.style.visibility="hidden")):void i(r.message)}}}function a(){w.off("message",s)}if(void 0===t||"object"!=typeof t)throw 400;if(void 0===e||"string"!=typeof e)throw 400;if(void 0===n||"function"!=typeof n)throw 400;if(void 0===i||"function"!=typeof i)throw 400;var l,h,f=[],u=!1,d=!1,p=!1,g=t.getMatrix(),_=document.createElement("div");_.classList.add("thr0w_base_cover"),_.style.visibility="hidden",t.getFrame().appendChild(_);for(var v=0;v<g.length;v++)for(var m=0;m<g[v].length;m++)f.push(g[v][m]),y===g[v][m]&&(l=m,h=v);w.on("message",s),c(f,{thr0w:{type:"sync",_id:e,hello:!0}}),this.update=o,this.idle=r,this.destroy=a}function u(){this._listeners={}}var d,w=null,y=null,p={};p.setBase=t,p.addAdminTools=e,p.getChannel=n,p.login=i,p.logout=o,p.authenticated=r,p.thr0w=s,p.connect=a,p.thr0wChannel=c,p.Grid=l,p.FlexGrid=h,p.Sync=f,p.EventTarget=u,window.thr0w=p,u.prototype={addListener:function(t,e){"undefined"==typeof this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].push(e)},fire:function(t){if("string"==typeof t&&(t={type:t}),t.target||(t.target=this),!t.type)throw new Error("Event object missing 'type' property.");if(this._listeners[t.type]instanceof Array)for(var e=this._listeners[t.type],n=0,i=e.length;i>n;n++)e[n].call(this,t)},removeListener:function(t,e){if(this._listeners[t]instanceof Array)for(var n=this._listeners[t],i=0,o=n.length;o>i;i++)if(n[i]===e){n.splice(i,1);break}}}}();